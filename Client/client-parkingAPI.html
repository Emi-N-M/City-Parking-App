<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Parkings</title>
    <script type="text/javascript">
        const ws = new WebSocket('ws://localhost:8080');
        const READ_DB_REQUEST = "READ_PARKING_DB_REQUEST"
        let parkingsJSON

        //Send request to get all parkings
        ws.onopen = (event) => {
            ws.send(READ_DB_REQUEST)
        }

        ws.onmessage = (msg) => {
            parkingsJSON = JSON.parse(msg.data)
            displayParkings()
        }

        function displayParkings() {

            console.log("Capacidad: ", parkingsJSON[0].capacity)
            console.log("longitud: ", parkingsJSON[0].location.latitude)
            const parking_container = document.getElementsByClassName("parking-container")
            for (let x = 0; x < parkingsJSON.length; x++) {
                const parking_data_map = readJsonParkingObject(parkingsJSON[x])
                console.log(parking_data_map)

                //Create Parking div
                var parkingDiv = document.createElement("div")          
                parkingDiv.className = "parking-element" + x.toString() 
                //Create textBoxes
                parkingDiv.appendChild(document.createElement("p"))
                        .appendChild(document.createTextNode("Name: " + parking_data_map.Name))
            
                parkingDiv.appendChild(document.createElement("p"))
                        .appendChild(document.createTextNode("Capacity: " + parking_data_map.Capacity))

                parkingDiv.appendChild(document.createElement("p"))
                .appendChild(document.createTextNode("Longtitude: " + parking_data_map.Longtitude))
                parkingDiv.appendChild(document.createElement("p"))
                .appendChild(document.createTextNode("Latitude: " + parking_data_map.Latitude))
                parkingDiv.appendChild(document.createElement("p"))
                .appendChild(document.createTextNode("Normal Price: " + parking_data_map.Normal_Price))
                parkingDiv.appendChild(document.createElement("p"))
                .appendChild(document.createTextNode("Client Price: " + parking_data_map.Client_Price))

                //Add Parking div to parking-container div
                parking_container.item(0).appendChild(parkingDiv)
            }


        }

        function readJsonParkingObject(jsonParking) {
            const name = jsonParking.name
            const capacity = jsonParking.capacity

            const longtitude = jsonParking.location.longtitude
            const latitude = jsonParking.location.latitude

            const normal_price = jsonParking.price_per_hour.normal
            const client_price = jsonParking.price_per_hour.client

       

            const toret = { "Name":  name,
                            "Capacity": capacity,
                            "Longtitude": longtitude,
                            "Latitude": latitude,
                            "Normal_Price": normal_price,
                            "Client_Price": client_price}
            return toret
        }

    </script>
    <style>
        html, body {
            height: 100%;
        }

        html {
            display: grid;
            margin: auto;
        }
        h1 {
            text-align: center;
            color: #EFEFEF;
            border-bottom: #ba1e29;
            border-bottom-style: solid;
            border-bottom-width: 3px;
            padding-bottom: 15px;
        }

        body {
            font-family: Arial, Helvetica, sans-serif;
            display: table-cell;
            vertical-align: middle;
            border-style: solid;
            border-width: 3px;
            border-radius: 5px;
            border-color: #ba1e29;
            background-image: linear-gradient(#cb2d3e, #ef473a, #cb2d3e);
        
        }

        .parking-container {
            display: flex;
            vertical-align: middle;
         
            padding: 10px;
            color: #EFEFEF;


        }
        .parking-container div{
            padding: 10px;
            border-style: solid;
            border-width: 2px;
            border-radius: 5px;
            margin-top: 8x;
            margin-left: 8px;
            font-weight: bold;
            width:180px;
            height: 220px;
            max-width: 180px;
            min-width: 180px;
            max-height: 220px;
            min-height: 220px;
        }
        .parking-container div:hover {
            background-image: linear-gradient(#ECE9E6, #ffffff, #ECE9E6);
            color: #ba1e29;
        }

    </style>
</head>
<body>
    <h1>Listado de Parkings</h1>
<div class="parking-container">
    
</div>


</body>
</html>